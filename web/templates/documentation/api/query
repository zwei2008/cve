{% extends 'layouts/api-accordion-child' %}
{% set id       = "query"                %}
{% set title    = "/api/query"           %}
{% set method   = "GET"                  %}
{% set headers  = [('rejected',      "Hide or show rejected CVEs",                                "show(default)/hide"),
                   ('cvss_score',    "CVSS score",                                                "6.8"),
                   ('cvss_modifier', "Select the CVSS score of the CVEs related to cvss_score",   "above/equals/below"),
                   ('time_start',    "Earliest time for a CVE",                                   "dd-mm-yyyy or dd-mm-yy format, using - or /"),
                   ('time_end',      "Latest time for a CVE",                                     "dd-mm-yyyy or dd-mm-yy format, using - or /"),
                   ('time_modifier', "Timeframe for the CVEs, related to the start and end time", "from/until/between/outside"),
                   ('time_type',     "Select which time is used for the filter",                  "Modified/Published/last-modified"),
                   ('skip',          "Skip the n latest vulnerabilities",                         "50"),
                   ('limit',         "Limit the amount of vulnerabilities to return",             "20"),
                   ]%}

{% block desc %}
Returns a list of CVEs matching the criteria of the filters specified in the headers.
{% endblock %}

{% block output %}
[
  {
    "Modified": {
      "$date": 1480730341713
    },
    "Published": {
      "$date": 1480730340167
    },
    "cvss": 10.0,
    "cwe": "CWE-287",
    "id": "CVE-2016-9796",
    "last-modified": {
      "$date": 1481117600060
    },
    "references": [
      "http://blog.malerisch.net/2016/12/alcatel-omnivista-8770-unauth-rce-giop-corba.html",
      "http://www.securityfocus.com/bid/94649",
      "https://github.com/malerisch/omnivista-8770-unauth-rce",
      "https://www.youtube.com/watch?v=aq37lQKa9sk"
    ],
    "summary": "Alcatel-Lucent OmniVista 8770 2.0 through 3.0 exposes different ORBs interfaces, which can be queried using the GIOP protocol on TCP port 30024. An attacker can bypass authentication, and OmniVista invokes methods (AddJobSet, AddJob, and ExecuteNow) that can be used to run arbitrary commands on the server, with the privilege of NT AUTHORITY\\SYSTEM on the server. NOTE: The discoverer states \"The vendor position is to refer to the technical guidelines of the product security deployment to mitigate this issue, which means applying proper firewall rules to prevent unauthorised clients to connect to the OmniVista server.\"",
    "vulnerable_configuration": [
      "cpe:2.3:a:alcatel-lucent:omnivista_8770_network_management_system:2.6",
  ...
{% endblock %}
